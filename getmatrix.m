function [N C CQ]=getmatrix(v1,v2,v3,v4,v5,v6,v7,w,d)
n11=-v2^2/(v3*v5);
n21=-3*n11;
n31=3*n11;
n41=-n11;
n14=(v2)^2/(v4*v7);
n23=3*(v2)^2/(v3*v6);
n33=3*(v2*v1)/(v3*v6);
n43=(v1)^2/(v3*v6);
n13=-(n23/3+n14+(v2)^2/(v4*v6));
n12=-(n11+n13+n14);
n22=3*n11-n23;
n24=0;
n32=-(3*n11+n33);
n34=0;
n42=1+n11-n43;
n44=0;








N=[n11,n12,n13,n14;
    n21,n22,n23,n24;
    n31,n32,n33,n34;
    n41,n42,n43,n44];


C00=n11*w(1,1)+n12*w(1,2)+n13*w(1,3)+n14*w(1,4);
C11=n21*w(1,1)+n22*w(1,2)+n23*w(1,3)+n24*w(1,4);
C22=n31*w(1,1)+n32*w(1,2)+n33*w(1,3)+n34*w(1,4);
C33=n41*w(1,1)+n42*w(1,2)+n43*w(1,3)+n44*w(1,4);

C0=n11*w(1,1)*d(1,:)+n12*w(1,2)*d(2,:)+n13*w(1,3)*d(3,:)+n14*w(1,4)*d(4,:);
C1=n21*w(1,1)*d(1,:)+n22*w(1,2)*d(2,:)+n23*w(1,3)*d(3,:)+n24*w(1,4)*d(4,:);
C2=n31*w(1,1)*d(1,:)+n32*w(1,2)*d(2,:)+n33*w(1,3)*d(3,:)+n34*w(1,4)*d(4,:);
C3=n41*w(1,1)*d(1,:)+n42*w(1,2)*d(2,:)+n43*w(1,3)*d(3,:)+n44*w(1,4)*d(4,:);

C=[C0;C1;C2;C3];
CQ=[C00;C11;C22;C33];
end